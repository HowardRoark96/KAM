<nz-form-item
  *ngIf="control"
  [class.validation]="control.dirty && (getErrorMessage | executeWith : control.errors)"
  [class.mb-0]="noMarginBottom"
  [class.mb-3]="!noMarginBottom"
>
  <nz-form-label
    *ngIf="label"
    [nzFor]="fieldId"
    [nzTooltipTitle]="tooltipTitle"
    [nzTooltipIcon]="tooltipIcon"
    [nzLabelAlign]="labelAlign"
    [nzNoColon]="noColon"
    [nzSpan]="labelSpan"
  >
    {{ label }}
    <span *ngIf="!noValidationMark && hasRequiredValidator" class="required">*</span>
  </nz-form-label>

  <nz-form-control
    class="w-100 mb-0"
    [nzValidateStatus]="status"
    [nzErrorTip]="getErrorMessage | executeWith : control.errors"
    [nzSpan]="fieldSpan"
  >
    <nz-input-group
      [nzAddOnBefore]="textBefore"
      [nzAddOnAfter]="textAfter"
      [nzPrefix]="prefix"
      [nzPrefixIcon]="prefixIcon"
      [nzSuffix]="suffix"
      [nzSuffixIcon]="suffixIcon"
      [nzSize]="fieldSize"
    >
      <nz-select
        *ngIf="!customContentTemplate"
        [nzId]="fieldId"
        [formControl]="control"
        [nzOptions]="options ?? []"
        [nzAutoClearSearchValue]="isAutoClearSearch"
        [nzAllowClear]="isAllowClear"
        [nzBackdrop]="isBackdrop"
        [nzBorderless]="isBorderless"
        [nzOpen]="isOpen"
        [nzDisabled]="isDisabled"
        [nzDropdownClassName]="dropdownClassName ?? null"
        [nzDropdownMatchSelectWidth]="isDropdownWidthAsSelect"
        [nzDropdownStyle]="dropdownStyle ?? null"
        [nzCustomTemplate]="customTemplate ?? null"
        [nzServerSearch]="isServerSearch"
        [nzFilterOption]="filterOptionFn"
        [nzMaxMultipleCount]="maxMultipleCount"
        [nzMode]="mode"
        [nzPlacement]="placement"
        [nzNotFoundContent]="notFoundContent"
        [nzPlaceHolder]="placeholder"
        [nzShowArrow]="isShowArrow"
        [nzShowSearch]="isShowSearch"
        [nzSize]="fieldSize"
        [nzStatus]="status"
        [nzSuffixIcon]="suffixIcon ?? null"
        [nzRemoveIcon]="removeIcon ?? null"
        [nzClearIcon]="clearIcon ?? null"
        [nzMenuItemSelectedIcon]="menuItemSelectedIconIcon ?? null"
        [nzTokenSeparators]="tokenSeparators"
        [nzLoading]="isLoading"
        [nzMaxTagCount]="maxTagCount"
        [nzMaxTagPlaceholder]="maxTagPlaceholder ?? defauldMaxTagPlaceholder"
        [nzOptionHeightPx]="optionHeightPx"
        [nzOptionOverflowSize]="optionOverflowSize"
        (ngModelChange)="valueChange.emit($event)"
        (nzOpenChange)="openChanged.emit($event)"
        (nzScrollToBottom)="scrollToBottom.emit($event)"
        (nzOnSearch)="searchChanged.emit($event)"
      ></nz-select>
      <nz-select
        *ngIf="customContentTemplate"
        [nzId]="fieldId"
        [formControl]="control"
        [nzAutoClearSearchValue]="isAutoClearSearch"
        [nzAllowClear]="isAllowClear"
        [nzBackdrop]="isBackdrop"
        [nzBorderless]="isBorderless"
        [nzOpen]="isOpen"
        [nzDisabled]="isDisabled"
        [nzDropdownClassName]="dropdownClassName ?? null"
        [nzDropdownMatchSelectWidth]="isDropdownWidthAsSelect"
        [nzDropdownStyle]="dropdownStyle ?? null"
        [nzCustomTemplate]="customTemplate ?? null"
        [nzServerSearch]="isServerSearch"
        [nzFilterOption]="filterOptionFn"
        [nzMaxMultipleCount]="maxMultipleCount"
        [nzMode]="mode"
        [nzPlacement]="placement"
        [nzNotFoundContent]="notFoundContent"
        [nzPlaceHolder]="placeholder"
        [nzShowArrow]="isShowArrow"
        [nzShowSearch]="isShowSearch"
        [nzSize]="fieldSize"
        [nzStatus]="status"
        [nzSuffixIcon]="suffixIcon ?? null"
        [nzRemoveIcon]="removeIcon ?? null"
        [nzClearIcon]="clearIcon ?? null"
        [nzMenuItemSelectedIcon]="menuItemSelectedIconIcon ?? null"
        [nzTokenSeparators]="tokenSeparators"
        [nzLoading]="isLoading"
        [nzMaxTagCount]="maxTagCount"
        [nzMaxTagPlaceholder]="maxTagPlaceholder ?? defauldMaxTagPlaceholder"
        [nzOptionHeightPx]="optionHeightPx"
        [nzOptionOverflowSize]="optionOverflowSize"
        (ngModelChange)="valueChange.emit($event)"
        (nzOpenChange)="openChanged.emit($event)"
        (nzScrollToBottom)="scrollToBottom.emit($event)"
        (nzOnSearch)="searchChanged.emit($event)"
      >
        <ng-container *ngIf="customContentTemplate">
          <nz-option
            *ngFor="let option of options"
            nzCustomContent
            [nzValue]="option.value"
            [nzLabel]="option.label?.toString() ?? null"
          >
            <ng-container
              [ngTemplateOutlet]="customContentTemplate"
              [ngTemplateOutletContext]="{ $implicit: option ?? null }"
            ></ng-container>
          </nz-option>
        </ng-container>
      </nz-select>
    </nz-input-group>
  </nz-form-control>
</nz-form-item>

<ng-template #defauldMaxTagPlaceholder let-selectedList>and {{ selectedList.length }} more</ng-template>
